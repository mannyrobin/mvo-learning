!function(e,n,a){"use strict";function o(n){var a=e(n),o=a.data("popmake"),t=e("form",a);t.length&&!e('[name="popmake_pa_conversion_check"]',t).length&&(t.find(".gform_body").length||t.hasClass("ninja-forms-form")||t.hasClass("wpcf7-form"))&&(t.addClass("popmake_pa"),t.append('<input type="hidden" name="_popmake_pa_conversion_check" value="'+o.id+'"/>'),t.append('<input type="hidden" name="_popmake_pa_open_event_id" value=""/>'),t.bindFirst("submit",function(){e('[name="_popmake_pa_open_event_id"]',t).val(a.data("open-event-id")),e.fn.popmake.conversion_trigger=t.attr("id")||e.fn.popmake.utilities.getXPath(t)}))}function t(){e(n).trigger("popmakeConversion")}e.fn.popmake.conversion_trigger=null,e.fn.bindFirst===a&&(e.fn.bindFirst=function(n,a){var o,t,p=e(this);p.unbind(n,a),p.bind(n,a),o=e._data(p[0]).events,t=o[n],t.unshift(t.pop()),o[n]=t}),e.fn.outerHtml===a&&(e.fn.outerHtml=function(){var n=e(this).clone(),a=e("<div/>").append(n);return a.html()}),e(n).on("popmakeConversion",function(){var n=e.fn.popmake.last_open_popup,a={action:"popmake_pa",popup_id:n.data("popmake").id,event_type:"conversion",open_event_id:n.data("open-event-id"),trigger:e.fn.popmake.conversion_trigger,_ajax_nonce:popmake_pa_nonce};e.ajax({type:"POST",dataType:"json",url:ajaxurl,async:!1,data:a})}),e(".popmake").on("popmakeInit",function(){var n=e(this),p=n.data("popmake"),i=p.meta.convert_on;if(o(this),i!==a&&""!==i)switch(i){case"form_submit":n.find("form").filter(":not(.popmake_pa)").on("submit.popmake_pa",function(){e.fn.popmake.conversion_trigger=e(this).attr("id")||"Form Submit",t(),e(this).off("submit.popmake_pa")});break;case"button_click":n.find("button, .button, .btn").on("click",function(){console.log(e(this)),e.fn.popmake.conversion_trigger=e(this).attr("id")||"Button Click",t()});break;case"link_click":n.find("a").on("click",function(){e.fn.popmake.conversion_trigger=e(this).attr("id")||"Link Click",t()})}}).on("popmakeBeforeOpen.analytics",function(){var n=e(this),a={action:"popmake_pa",popup_id:n.data("popmake").id,event_type:"open",trigger:null,_ajax_nonce:popmake_pa_nonce},o=null;try{o=e(e.fn.popmake.last_open_trigger)}catch(t){o=e()}o.length?a.trigger=o.eq(0).outerHtml():null!==e.fn.popmake.last_open_trigger&&(a.trigger=e.fn.popmake.last_open_trigger.toString()),e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:a,success:function(e){e.success&&e.event_id>0?n.data("open-event-id",e.event_id):n.data("open-event-id",null)}}),e(window).one("unload.popmake_pa",function(){a={action:"popmake_pa",popup_id:n.data("popmake").id,event_type:"close",open_event_id:n.data("open-event-id"),trigger:"Browser Closed",_ajax_nonce:popmake_pa_nonce},e.ajax({type:"POST",dataType:"json",url:ajaxurl,async:!1,data:a})})}).on("popmakeBeforeClose.analytics",function(){var n=e(this),a={action:"popmake_pa",popup_id:n.data("popmake").id,event_type:"close",open_event_id:n.data("open-event-id"),trigger:e.fn.popmake.last_close_trigger,_ajax_nonce:popmake_pa_nonce};e(window).off("unload.popmake_pa"),e.ajax({type:"POST",dataType:"json",url:ajaxurl,data:a})})}(jQuery,document);