'use strict';window.tsfemForm={nonce:tsfemFormL10n.nonce,i18n:tsfemFormL10n.i18n,callee:tsfemFormL10n.callee,parseElementData:function(a,b){let c,d=tsfemForm.getElementData(a,b);try{c=d&&JSON.parse(d)}catch(a){c=d}finally{return c}},getElementData:function(a,b){return 0===b.indexOf("data-")&&(b=jQuery.camelCase(b.slice(5))),!!a.dataset.hasOwnProperty(b)&&a.dataset[b]},setupIterations:function(){let a=jQuery(".tsfem-form-iterator-selector-wrap input");if(!a.length)return;tsfemForm.prepareItItems(a);let b,c,d,e,f,g,h,i,j=0,k=0,l=0;const m=function(){b=document.createElement("span"),b.className="tsfem-form-iterator-timer",c=document.createElement("span"),c.style.width="0%",b.appendChild(c)};m(),d=1500/200,d*=.975;const n=function(){c.style.width=++k/2+"%"},o=function(){k=0,c.style.width="0%",b.classList.remove("tsfem-form-iterator-timer-invalid")},p=function(){k=100,c.style.width=k+"%",b.classList.add("tsfem-form-iterator-timer-invalid")},q=function(){h&&h.remove(),f=g=h=void 0,m(),setTimeout(function(){a.prop("disabled",!1)},500),a.off("input.fIt").on("input.fIt",e)},r=function(){a.off("input.fIt"),a=jQuery(".tsfem-form-iterator-selector-wrap input"),tsfemForm.prepareItItems(a),tsfemForm.prepareCollapseItems(),tsfemForm.setupGeo(),a.on("input.fIt",e),tsfTT.triggerReset(),i=void 0},s=function(){i&&(i.value=i.dataset.tsfemFormPrevValue)};let t=jQuery(window);t.on("tsfemForm.iterationFail",s),t.on("tsfemForm.iterationLoad tsfemForm.deiterationLoad tsfemForm.iterationFail",q),t.on("tsfemForm.iterationComplete tsfemForm.deiterationComplete tsfemForm.iterationFail",r),e=function(k){return clearInterval(l),clearTimeout(j),o(),tsfemForm.disableSubmit(k.target.form),i=k.target,k.target.checkValidity()?void(l=setInterval(n,d),!f&&(f=jQuery(k.target),g=f.closest(".tsfem-form-setting").find(".tsfem-form-setting-label-inner-wrap"),a.not(k.target).prop("disabled",!0),g.append(b),h=g.find("span.tsfem-form-iterator-timer")),j=setTimeout(function(){if(f.prop("disabled",!0),clearInterval(l),c.style.width="100%",+k.target.value==+k.target.dataset.tsfemFormPrevValue)q(),tsfemForm.enableSubmit(k.target.form);else if(+k.target.value<+k.target.dataset.tsfemFormPrevValue)tsfemForm.unloadIterations(k.target),tsfemForm.enableSubmit(k.target.form);else if(40<+k.target.value){200<+k.target.value?tsfem.dialog({title:tsfemFormL10n.i18n.performanceWarning,text:[tsfemFormL10n.i18n.itHugeConfirm,tsfemFormL10n.i18n.aysProceed],confirm:tsfemFormL10n.i18n.proceed,cancel:tsfemFormL10n.i18n.cancel}):tsfem.dialog({title:tsfemFormL10n.i18n.performanceWarning,text:[tsfemFormL10n.i18n.itLargeConfirm,tsfemFormL10n.i18n.aysProceed],confirm:tsfemFormL10n.i18n.proceed,cancel:tsfemFormL10n.i18n.cancel});let a={};a._cancel=function(){s(),q(),a._reset(),tsfemForm.enableSubmit(k.target.form)},a._confirm=function(){tsfemForm.loadIterations(k.target),a._reset()},a._reset=function(){window.removeEventListener("tsfem_modalCancel",a._cancel),window.removeEventListener("tsfem_modalConfirm",a._confirm)},window.addEventListener("tsfem_modalCancel",a._cancel),window.addEventListener("tsfem_modalConfirm",a._confirm)}else tsfemForm.loadIterations(k.target)},1500)):void p()},a.on("input.fIt",e)},unloadIterations:function(a){if(a){let b=a.id.slice(0,a.id.lastIndexOf("[")),c=document.getElementById(b+"-wrapper");c.style.willChange="contents";let d=jQuery(window),e=jQuery(c).children(".tsfem-form-collapse").slice(a.value);d.trigger("tsfemForm.deiterationLoad",[a,e]),e.remove(),d.trigger("tsfemForm.deiterationComplete"),c.style.willChange="auto"}},loadIterations:function(a){if(!a)return;let b=a.id.slice(0,a.id.lastIndexOf("[")),c=jQuery(a).closest(".tsfem-pane-wrap").find(".tsfem-pane-header .tsfem-ajax"),d=0,e="",f=document.getElementById(b+"-wrapper"),g=document.createElement("div");g.className="tsfem-flex-status-loading tsfem-flex tsfem-flex-center",g.appendChild(document.createElement("span")),f.appendChild(g),tsfem.resetAjaxLoader(c),tsfem.setAjaxLoader(c),jQuery.ajax({method:"POST",url:ajaxurl,dataType:"html",data:{action:"tsfemForm_iterate",nonce:tsfemForm.nonce,args:{caller:b,callee:tsfemForm.callee,previousIt:a.dataset.tsfemFormPrevValue,newIt:a.value}},timeout:1e4,async:!0}).done(function(b,c,g){let h=g.getResponseHeader("content-type"),i=jQuery(window);i.trigger("tsfemForm.iterationLoad"),-1<h.indexOf("json")?(a.value=a.dataset.tsfemFormPrevValue,tsfem.unexpectedAjaxErrorNotice(b),e=tsfem.i18n.InvalidResponse,i.trigger("tsfemForm.iterationFail")):(jQuery(f).append(b),d=1,i.trigger("tsfemForm.iterationComplete"))}).fail(function(a,b,c){e=tsfem.getAjaxError(a,b,c),c&&tsfem.setTopNotice(-1,"jQ error: "+c),jQuery(window).trigger("tsfemForm.iterationFail")}).always(function(){f.removeChild(g),tsfemForm.enableSubmit(a.form),tsfem.updatedResponse(c,d,e,0)})},prepareItItems:function(a){a.each(function(a,b){b.dataset.tsfemFormPrevValue=b.value})},setupGeo:function(){if(!jQuery("[data-geo-api-component=\"action\"]").length)return;let a,b,c=!1;(function(){a=document.createElement("div"),a.className="tsfem-form-setting-action tsfem-flex",a.dataset.geoApiIsButtonWrap=1,a.style.opacity=0;let c=document.createElement("button");c.className="tsfem-button-primary tsfem-button-primary-bright tsfem-button-cloud",c.innerHTML=tsfemForm.i18n.validate,c.type="button",a.appendChild(c),b=document.createElement("div"),b.className="tsfem-description tsfem-form-option-description",b.dataset.geoApiIsButtonWarning=1,b.style.opacity=0,b.innerHTML=tsfemForm.i18n.reverseGeoWarning})();const d=function(a,b){let d=jQuery(a).closest("[data-geo-api-component=\"action\"]"),e=j(d);c=!0,e.each(function(a,c){let d=tsfemForm.parseElementData(c,"geoApiComponent"),e={};d="object"==typeof d&&d||{0:d};loopComponents:for(let a in d){if(b.hasOwnProperty(d[a]))switchComponents:switch(d[a]){case"route":case"street_number":if(1<d.length){if(e[d[a]]=b[d[a]],1<Object.keys(e).length){c.value=e.route+" "+e.street_number;break loopComponents}break switchComponents}else{c.value=b[d[a]];break loopComponents}break;case"locality":case"country":case"postal_code":case"region":c.value=b[d[a]];break loopComponents;case"lat":case"lng":c.value=parseFloat(parseFloat(b[d[a]]).toFixed(7));break loopComponents;default:break loopComponents;}continue}jQuery(c).trigger("change")}),c=!1},e=function(a,b){let c={},e={};loopData:for(let a in b){let d=b[a].address_components,f=b[a].geometry.location;c[a]={},e[a]=b[a].formatted_address,c[a].lat=f.lat,c[a].lng=f.lng;loopComponents:for(let b in d){let e=d[b].short_name,f=d[b].types;loopTypes:for(let b in f)switchTypes:switch(f[b]){case"route":case"street_number":case"country":case"postal_code":c[a][f[b]]=e;break loopTypes;case"locality":c[a].locality=e;break loopTypes;case"postal_town":f.locality||(c[a].locality=e);break loopTypes;case"administrative_area_level_1":c[a].region=e;break loopTypes;case"administrative_area_level_2":f.administrative_area_level_1||(c[a].region=e);break loopTypes;default:break switchTypes;}}1<b.length&&!c[a].hasOwnProperty("route")&&(delete c[a],delete e[a])}if(!Object.keys(c).length)tsfem.setTopNotice(17004),i(jQuery(a).closest("[data-geo-api-component=\"action\"]"));else{tsfem.dialog({title:tsfemFormL10n.i18n.selectAddressTitle,text:tsfemFormL10n.i18n.selectAddressText,select:e,confirm:tsfemFormL10n.i18n.select,cancel:tsfemFormL10n.i18n.cancel});let b={};b._cancel=function(){tsfemForm.enableButton(a),b._close()},b._confirm=function(f){if("checked"in f.detail){let b=c[f.detail.checked];void 0!==b&&d(a,b)}i(jQuery(a).closest("[data-geo-api-component=\"action\"]")),b._close()},b._close=function(){window.removeEventListener("tsfem_modalCancel",b._cancel),window.removeEventListener("tsfem_modalConfirm",b._confirm)},window.addEventListener("tsfem_modalCancel",b._cancel),window.addEventListener("tsfem_modalConfirm",b._confirm)}},f=function(a){let b=jQuery(a.target).closest("[data-geo-api-component=\"action\"]"),c=j(b),d={};tsfemForm.disableButton(a.target),c.each(function(a,b){b.value&&(d[b.dataset.geoApiComponent]=b.value)});let f={target:a.target,callbacks:{success:e,failure:function(){tsfemForm.enableButton(a.target)},always:function(){}}};tsfemForm.getGeoData(d,a.target.dataset.formId,f)},g=function(c,d,e){if(e=void 0===e?1:e,!e)return i(c);let g=c&&c.find(".tsfem-form-multi-setting-label-inner-wrap");if(!g.length)return;if(!c.data("geo-api-has-button")){let b=a.cloneNode(!0);g.append(b),c.data("geo-api-has-button",1),b.getElementsByTagName("button")[0].dataset.formId=d,b.getElementsByTagName("button")[0].addEventListener("click",f),tsfem.fadeIn(b,300)}let h=g.find("[data-geo-api-is-button-warning]").first();if(2===e){if(h.length)return;let a=b.cloneNode(!0);g.append(a),tsfem.fadeIn(a,300)}else{if(!h.length)return;tsfem.fadeOut(h[0],300,()=>h[0].remove())}},h=function(a,b,c){g(a,b,c)},i=function(a){let b=a&&a.find(".tsfem-form-multi-setting-label-inner-wrap")||void 0;b&&b.find(b.children("[data-geo-api-is-button-wrap], [data-geo-api-is-button-warning]")).fadeOut(300,function(){this.remove(),a.removeData("geo-api-has-button")})},j=function(a){return a.find("[data-geo-api=\"1\"]")},k=function(a){let b=j(a);if(!b.length)return 0;let c,d=0,e=b.filter("[data-geo-api-component=\"lat\"]").first().val(),f=b.filter("[data-geo-api-component=\"lng\"]").first().val();if(b.each(function(a,b){if(-1<jQuery(b).data("geo-api-component").indexOf("route"))return c=b.value,!1}),e&&f)d=/^(\-|\+)?([0-9]+(\.[0-9]+)?)$/.test(e)&&-90<=e&&90>=e?2:0,d=d&&/^(\-|\+)?([0-9]+(\.[0-9]+)?)$/.test(f)&&-180<=f&&180>=f?2:0;else if(c&&(d=/^((([0-9\/-]+([\/-0-9A-Z]+)?(\s|(,\s)))([\u00a1-\uffffa-zA-Z\.\s]|[0-9_/-])+))|(([\u00a1-\uffffa-zA-Z\.\s]|[0-9_/-])+)((\s|(,\s))([0-9\/-]+([\/-0-9A-Z]+)?))$/.test(c)?1:0,!d)){let a=0;b.not("[data-geo-api-component=\"lat\"], [data-geo-api-component=\"lng\"]").each((b,c)=>{if(c.value.length&&1<++a)return!1}),d=1<a}return d};let l=0;const m=function(a){c||(clearTimeout(l),l=setTimeout(function(){if(tsfemForm.getElementData(a.target,"geoApiComponent")){let b=jQuery(a.target).closest("[data-geo-api-component=\"action\"]"),c=k(b);b.data("geo-api-has-button")?c?h(b,a.target.form.id,c):i(b):g(b,a.target.form.id,c)}},500))};let n=jQuery("input[data-geo-api=\"1\"]"),o=jQuery("select[data-geo-api=\"1\"]");n&&n.off("input.tsfemForm.addButtonIfValid").on("input.tsfemForm.addButtonIfValid",m),o&&o.off("change.tsfemForm.addButtonIfValid").on("change.tsfemForm.addButtonIfValid",m)},getGeoData:function(a,b,c){let d=document.getElementById(b),e=jQuery(d).closest(".tsfem-pane-wrap").find(".tsfem-pane-header .tsfem-ajax"),f=0,g="";return tsfemForm.disableSubmit(d),tsfem.resetAjaxLoader(e),tsfem.setAjaxLoader(e),jQuery.ajax({method:"POST",url:ajaxurl,dataType:"json",data:{action:"tsfemForm_get_geocode",nonce:tsfemForm.nonce,input:JSON.stringify(a)},processData:!0,timeout:14e3,async:!0}).done(function(a){a=tsfem.convertJSONResponse(a),tsfem.debug&&console.log(a);let b=a&&a.data||void 0,d=a&&a.type||void 0;b&&d?"failure"===d?(tsfem.unexpectedAjaxErrorNotice(a),c.callbacks.failure(c.target)):"geodata"in b&&(f=1,c.callbacks.success(c.target,b.geodata.results)):g=tsfem.i18n.InvalidResponse}).fail(function(a,b,d){g=tsfem.getAjaxError(a,b,d),tsfem.setTopNotice(17200),d&&tsfem.setTopNotice(-1,"jQ error: "+d),c.callbacks.failure(c.target)}).always(function(){tsfem.updatedResponse(e,f,g,0),tsfemForm.enableSubmit(d),c.callbacks.always(c.target)})},prepareCollapseItems:function(){jQuery(".tsfem-form-collapse > input").off("change.tsfemForm.prepareItems").on("change.tsfemForm.prepareItems",function(a){tsfemForm.prepareCollapseTitles(a),tsfemForm.prepareCollapseValidity(a)}).trigger("change.tsfemForm.prepareItems")},prepareCollapseTitles:function(a){const b=function(a){let b=jQuery(a.data._tsfemFormLabel),c=b.find(".tsfem-form-collapse-title"),d=b.data("dyntitleprep"),e=jQuery(a.target).val();e?c.text(d+" - "+e):c.text(d)},c=function(a){let b=a.target.checked||!1,c=jQuery(a.data._tsfemFormLabel),d=c.find(".tsfem-form-collapse-title"),e=c.data("dyntitleprep");b?d.text(e+" - "+c.data("dyntitlechecked")):d.text(e)},d=function(a){let b=jQuery(a.data._tsfemFormLabel),c=b.find(".tsfem-form-collapse-title"),d=b.data("dyntitleprep"),e=[];jQuery(a.data._tsfemFormThings).map((a,b)=>{b.checked&&e.push(b.value)});let f=e.join(", ");f?c.text(d+" - "+f):c.text(d)};(function(a){let e,f=jQuery(a.target).siblings("label"),g=f.data("dyntitletype"),h=f.data("dyntitleid")+"["+f.data("dyntitlekey")+"]";switch(g){case"single":case"checkbox":let a=document.getElementById(h);e="input.tsfemForm.doTitleChangeSingle",jQuery(a).off(e).on(e,{_tsfemFormLabel:f},"checkbox"===g?c:b).trigger(e);break;case"plural":let i=jQuery(document.getElementById(h)).find("input[type=checkbox]");e="input.tsfemForm.doTitleChangeSingle";;i.off(e).on(e,{_tsfemFormLabel:f,_tsfemFormThings:i},d).trigger(e);}})(a)},prepareCollapseValidity:function(a){const b=function(a,b){let c=".tsfem-form-title-icon",d="tsfem-form-title-icon-unknown",e="tsfem-form-title-icon-error",f="tsfem-form-title-icon-good";0<b?(a.removeClass("tsfem-form-collapse-header-good").addClass("tsfem-form-collapse-header-error"),a.find(c).removeClass(d+" "+f).addClass(e)):0>b?(a.removeClass("tsfem-form-collapse-header-error tsfem-form-collapse-header-good").addClass("tsfem-form-collapse-header-good"),a.find(c).removeClass(f+" "+e).addClass(d)):(a.removeClass("tsfem-form-collapse-header-error").addClass("tsfem-form-collapse-header-good"),a.find(c).removeClass(d+" "+e).addClass(f))},c=function(a,c){let d,e;a.each(function(a,f){d=jQuery(f),e=(+d.data("tsfemErrorCount")||0)+c,d.data("tsfemErrorCount",e),b(d,e)})},d=function(a){let b=0;b="tsfemWasValid"in a.target.dataset?+a.target.dataset.tsfemWasValid:a.target.dataset.tsfemWasValid=1;let d=a.target.disabled||a.target.checkValidity(),e=jQuery(a.target).parents(".tsfem-form-collapse").children(".tsfem-form-collapse-header"),f=+e.data("tsfemErrorCount");f?b&&!d?(a.target.dataset.tsfemWasValid=+d,c(e,1)):!b&&d&&(a.target.dataset.tsfemWasValid=+d,c(e,-1)):d?c(e,0):(a.target.dataset.tsfemWasValid=+d,c(e,1))},e=function(a,b){let c=a.dataset.tsfemDidInitialValidation||0;c||(b.on("tsfemForm.first.checkValidity",d),b.each((a,b)=>{jQuery(b).trigger("tsfemForm.first.checkValidity")}),b.off("tsfemForm.first.checkValidity"),a.dataset.tsfemDidInitialValidation=1)};(function(a){let b=jQuery(a.target).siblings(".tsfem-form-collapse-content").find("input, select, textarea").not(".tsfem-form-collapse-checkbox");b.off("change.tsfemForm.checkValidity"),a.target.checked||b.on("change.tsfemForm.checkValidity",d),e(a.target,b)})(a),tsfemForm.prepareCustomChecks(d),tsfemForm.prepareDeiterationValidityChecks(d)},prepareCustomChecks:function(a){const b=function(b,c){if(c){let b=jQuery(c);b.length&&(b.one("tsfemForm.temp.customChecks.checkValidityCb",a),b.trigger("tsfemForm.temp.customChecks.checkValidityCb"))}},c=function(){jQuery(window).on("tsfemForm.customValidationChecks",b)},d=function(){jQuery(window).off("tsfemForm.customValidationChecks")};(function(){d(),c(),jQuery(window).off("tsfemForm.iterationLoad.customValidation").off("tsfemForm.iterationFail.customValidation").off("tsfemForm.iterationComplete.customValidation").on("tsfemForm.iterationLoad.customValidation",d).on("tsfemForm.iterationFail.customValidation",c).on("tsfemForm.iterationComplete.customValidation",c)})()},triggerCustomValidation:function(a){a instanceof HTMLElement&&jQuery(window).trigger("tsfemForm.customValidationChecks",[a])},prepareDeiterationValidityChecks:function(a){const b=function(b,c,d){if(d){let b=d.children(".tsfem-form-collapse-content").find("input:invalid, select:invalid, textarea:invalid");b&&(b.prop("disabled",!0),b.on("tsfemForm.temp.disableAndValidate.checkValidityCb",a),b.each((a,b)=>{jQuery(b).trigger("tsfemForm.temp.disableAndValidate.checkValidityCb")}),b.off("tsfemForm.temp.disableAndValidate.checkValidityCb"))}};(function(){jQuery(window).off("tsfemForm.deiterationLoad.disableAndValidate").on("tsfemForm.deiterationLoad.disableAndValidate",b)})()},setupSpecialRequired:function(){let a=document.createElement("input");(function(){a.className="tsfem-form-checkbox-required",a.setAttribute("type","checkbox"),a.setAttribute("required","required"),a.setAttribute("value","1"),a.setAttribute("tabIndex","-1")})();const b=function(a,b){let c=(+a.data("required-check-count")||0)+b;return a.data("required-check-count",c),c},c=function(b){if(!b.children(".tsfem-form-checkbox-required").length){let c=a.cloneNode(!1);c.setCustomValidity(tsfemForm.i18n.requiredSelectAny),jQuery(c).prependTo(b),tsfemForm.triggerCustomValidation(c)}b.removeClass("tsfem-form-multi-valid").addClass("tsfem-form-multi-invalid")},d=function(a){let b=a.children(".tsfem-form-checkbox-required");if(b.length){let c=b[0].cloneNode(!1);b.remove(),c.checked=!0,c.required=!1,jQuery(c).prependTo(a),tsfemForm.triggerCustomValidation(c),c.remove()}a.removeClass("tsfem-form-multi-invalid").addClass("tsfem-form-multi-valid")},e=function(a){if(a.target.disabled)return;let e,f=jQuery(a.target).closest(".tsfem-form-multi-select-wrap[data-required=\"1\"]"),g=f.data("required-check-count");e=a.target.checked?b(f,1):b(f,-1),1>g?e>g&&d(f):1>e&&c(f)},f=function(){let a,d,f,g=jQuery(".tsfem-form-multi-select-wrap[data-required=\"1\"]");g.each(function(g,h){d=h.dataset.requiredCheckCount,void 0===d&&(a=jQuery(h),a.find("input").on("change.tsfemForm.testChecked",e),f=a.find("input:checked").length,f?a.addClass("tsfem-form-multi-valid"):c(a),b(a,+f))})};f(),jQuery(window).on("tsfemForm.iterationComplete",f)},setupTypeListener:function(){const a=function(b,c){let d;if("object"==typeof b)for(let e in b)if(d=a(b[e],c),!1!==d)return e;return c===b&&c},b=function(b){let c,d,e;return(b.target.dataset.typeInitTested=1,c="checkbox"===b.target.type.toLowerCase()?b.target.checked?b.target.value:"0":b.target.value,!c)?(b.target.dataset.type="",void jQuery(b.target).trigger("tsfemForm.typeIsSet")):void(d=tsfemForm.parseElementData(b.target,"setTypeToIfValue"),d&&(e=a(d,c),b.target.dataset.type=e||"",jQuery(b.target).trigger("tsfemForm.typeIsSet")))},c=function(){let a=jQuery("[data-is-type-listener=\"1\"]");a.each(function(a,c){c.dataset.typeInitTested||jQuery(c).off("change.tsfemForm.typeListener").on("change.tsfemForm.typeListener",b).trigger("change.tsfemForm.typeListener")})};c(),jQuery(window).on("tsfemForm.iterationComplete",c)},setupShowIfListener:function(){let a="input, select, textarea",b={duration:150,easing:"linear",queue:!1,start:function(){this.style.willChange="opacity"},done:function(){let a=this.style.display;this.removeAttribute("style"),this.style.display=a}};const c=a=>{let b,c=a.dataset.isShown||void 0;try{b=JSON.parse(c)}catch(a){}if(b)for(let a in b)if(-1==+b[a])return!1;return!0},d=(a,b,c)=>{let d,e=a.dataset.isShown||void 0;try{d=JSON.parse(e)}catch(a){}return(d=d||{},!(d.hasOwnProperty(b)&&+c==+d[b]))&&(d[b]=+c,a.dataset.isShown=JSON.stringify(d),!0)},e=(a,b)=>{let c=a.dataset.disabledShowif;return a.dataset.disabledShowif=c?+c+b:+b},f=(c,f)=>{if(d(c,f,-1)){let d=jQuery(c);d.is(a)?(d.closest(".tsfem-form-setting").fadeOut(b),c.disabled=!0,e(c,1),tsfemForm.triggerCustomValidation(c)):(d.fadeOut(b),d.find(a).each((a,b)=>{b.disabled=!0,e(b,1),tsfemForm.triggerCustomValidation(b)}))}},g=(f,g)=>{if(d(f,g,1)){let d=jQuery(f);if(d.is(a))1>e(f,-1)&&(f.disabled=!1,tsfemForm.triggerCustomValidation(f),d.closest(".tsfem-form-setting").fadeIn(b));else{let f,g=d.hasClass("tsfem-form-multi-setting");d.find(a).each((a,b)=>(f=e(b,-1),g&&!c(b)||void(1>f&&(b.disabled=!1,tsfemForm.triggerCustomValidation(b),jQuery(b).show())))),d.fadeIn(b)}}},h=(a,c,d)=>{let e={};jQuery(c).off("tsfemForm.typeIsSet",a).on("tsfemForm.typeIsSet",a,()=>{clearTimeout(e[c.id]),e[c.id]=setTimeout(()=>{c.dataset.type===d?g(a,c.id):f(a,c.id),delete e[c.id]},b.duration+25)}),c.dataset.type===d?g(a,c.id):f(a,c.id)},i=a=>{let b=tsfemForm.parseElementData(a,"showif");if(!b)return;let c,d,e=jQuery(a).closest(".tsfem-form-collapse-content");for(d in e.length||(e=jQuery(a).closest(".tsfem-form-multi-setting")),b)break;if(d)return c=e?e.find("[data-showif-catcher=\""+d+"\"]"):jQuery(a.form).find("[data-showif-catcher=\""+d+"\"]"),c.length?{target:c[0],value:b[d]}:void 0},j=a=>{a.dataset.showIfIsInit="1";let b=i(a);b&&h(a,b.target,b.value)},k=()=>{let a=jQuery("[data-is-showif-listener=\"1\"]"),c=b.duration;b.duration=0,a.each((a,b)=>{b.dataset.showIfIsInit||j(b)}),b.duration=c};k(),jQuery(window).on("tsfemForm.iterationComplete",k)},adjustSubmit:function(){let a=jQuery("form.tsfem-form");a.each((a,b)=>{jQuery(document.querySelectorAll("[type=submit][form=\""+b.id+"\"]")).attr("onclick","tsfemForm.saveInput( event )")})},doValidityRoutine:function(a,b){if(b=b||tsfemFormL10n.i18n.collapseValidate,!a.checkValidity()){let c=a.querySelector("input:invalid, select:invalid, textarea:invalid"),d=!1;const e=function(){if(d)return void f();try{return void c.reportValidity()}catch(a){tsfem.debug&&console.log(a)}},f=function(){let a=jQuery(c).parents(".tsfem-form-collapse"),g=-1;if(a=jQuery(a.get().reverse()),jQuery(a).each((a,b)=>{let c=jQuery(b).children(".tsfem-form-collapse-checkbox").is(":checked");if(c)return g=a,!1}),-1===g)return d=!1,e();d=!0;let h,i,j;h=a.slice(g).first(),i=h.find(".tsfem-form-collapse-header").first(),j=h.find(".tsfem-form-collapse-checkbox").first();let k;const l=function(a){clearTimeout(k),k=setTimeout(function(){let b=document.documentElement.scrollTop,c=document.documentElement.clientHeight,d=a.offset().top,e=jQuery(".tsfem-sticky-top").height()+1*c/3,f=!1;d-e<b?f=!0:d+e>c+b&&(f=!0),f&&jQuery(document.documentElement).animate({scrollTop:d-e},500)},50)};tsfTT.doTooltip(void 0,i,b),l(i),j.off("change.tsfemForm.removeToolTip").on("change.tsfemForm.removeToolTip",function(a){let b=jQuery(a.target);tsfTT.removeTooltip(b.siblings(".tsfem-form-collapse-header")),b.off("change.tsfemForm.removeToolTip"),f()})};return c?f():e(),!1}return!0},saveInput:function(a){tsfemForm.preventSubmit(a);let b,c,d=a.target.getAttribute("form");if(d){if(b=document.getElementById(d),!b)return tsfemForm.preventSubmit(a);if(!tsfemForm.doValidityRoutine(b,tsfemFormL10n.i18n.collapseValidate))return;c=a.target}else b=a.target,c=document.querySelector("[type=submit][form=\""+b.id+"\"]");let e=jQuery(b).closest(".tsfem-pane-wrap").find(".tsfem-pane-header .tsfem-ajax"),f=0,g="";return tsfemForm.disableButton(c),tsfem.resetAjaxLoader(e),tsfem.setAjaxLoader(e),jQuery.ajax({method:"POST",url:ajaxurl,dataType:"json",data:{action:"tsfemForm_save",nonce:tsfemForm.nonce,data:jQuery(b).serialize()},processData:!0,timeout:14e3,async:!0}).done(function(a){a=tsfem.convertJSONResponse(a),tsfem.debug&&console.log(a);let b=a&&a.data||void 0,c=a&&a.type||void 0;if(!b||!c)g=tsfem.i18n.InvalidResponse;else{let a=b.results&&b.results.code||void 0;a?(b.data&&b.data.failed&&b.data.failed.length?(f=0,g=tsfem.i18n.UnknownError):f=1,tsfem.setTopNotice(a)):g=tsfem.i18n.UnknownError}}).fail(function(a,b,c){g=tsfem.getAjaxError(a,b,c),tsfem.setTopNotice(1071101),c&&tsfem.setTopNotice(-1,"jQ error: "+c)}).always(function(){tsfem.updatedResponse(e,f,g,0),tsfemForm.enableButton(c)}),!0},preventSubmit:function(a){return a.preventDefault(),a.stopPropagation(),!1},enableButton:function(a){setTimeout(function(){let b=jQuery(a);b.removeClass("tsfem-button-disabled tsfem-button-loading"),b.attr("disabled",!1)},1)},disableButton:function(a,b){b=!(void 0!==b)||b;let c=jQuery(a);b?c.addClass("tsfem-button-disabled tsfem-button-loading"):c.addClass("tsfem-button-disabled"),c.attr("disabled",!0)},enableSubmit:function(a){a&&a.id&&tsfemForm.enableButton("[form=\""+a.id+"\"]")},disableSubmit:function(a,b){a&&a.id&&tsfemForm.disableButton("[form=\""+a.id+"\"]",b)},doReady:function(){tsfemForm.setupIterations(),tsfemForm.setupGeo(),tsfemForm.setupSpecialRequired(),tsfemForm.setupTypeListener(),tsfemForm.setupShowIfListener(),tsfemForm.prepareCollapseItems(),tsfemForm.adjustSubmit()},ready:function(a){a(document.body).ready(tsfemForm.doReady)}},jQuery(tsfemForm.ready);
